<!--First is to iterate though the set of questions to get individual ones -->
<h2> List of questions posted </h2>
<% i = 1 %>
<% questions = Question.all %>
Questions count <%= questions.count %><br>
<% questions.each do |question| %>
	<%= "#{i})" %> <a href="/questions/<%= question.id %>"><%= question.title %></a> by <%= question.user.name%>

	<% if question.votes.count == 0 %>
		<% @can_vote = true %>
	<% else question.votes.each do |vote| %>
		<% if vote.user_id == session[:user_id] %>
			<% @can_vote = false %>	
			<form action="/upvote/<%= question.id %>/<%= vote.id %>/reset" method="POST">
				<input type="submit" value="upvote"></form>
			<form action="/downvote/<%= question.id %>/<%= vote.id %>/reset" method="POST">
				<input type="submit" value="downvote"></form>
			<form action="/questions/<%= question.id %>/<%= vote.id %>/reset" method="POST">
				<input type="submit" value="reset"></form>
			<% break %>
		<% else vote.user_id != session[:user_id] %>
			<% @can_vote = true %>
		<% end %>
	<% end %>
<% end %><br>
<!--we use the can_vote variable in order to ensure we don't get a repeat if question.votes.count == 0 -->
<% if @can_vote == true %>
	<a href="/questions/<%= question.id %>/upvote"><button>upvote</button></a>
	<a href="/questions/<%= question.id %>/downvote"><button>downvote</button></a><br>
<% end %>

	Total Vote(s): <%= question.votes.count %><br> 
	Total Upvote(s): <%= question.votes.where(vote_count: 1).count %><br>
	Total Downvote(s)	<%= question.votes.where(vote_count: -1).count %><br>
	<br>
	<% i += 1 %>
<% end %>